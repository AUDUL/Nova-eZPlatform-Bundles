{% extends '@EzPublishCore/content_fields.html.twig' %}

{# This field accepts the following parameters:
 #   - alias (image variation name). Defaults to "original" (e.g. image originally uploaded)
 #   - parameters.width. Allows forcing width of the image in the HTML
 #   - parameters.height. Allows forcing height of the image in the HTML
 #   - parameters.class. Allows setting CSS custom class name for the image
 #}
{% block enhancedimage_field %}
    {% spaceless %}
        {% if not ez_is_field_empty( content, field ) %}
            {% set attr = attr|merge({
                'class': (attr.class|default('') ~ ' enhancedimage--wrapper')|trim
                'data-focus-x': focusPoint ? focusPoint.posX : ''
                'data-focus-y': focusPoint ? focusPoint.posY : ''
                'data-image-h': parameters.height is defined ? parameters.height : (imageAlias ? imageAlias.height : '')
                'data-image-w': parameters.width is defined ? parameters.width : (imageAlias ? imageAlias.width : ''),
            }) %}
            <figure {{ block( 'field_attributes' ) }}>
                {% set imageAlias = ez_image_alias( field, versionInfo, parameters.alias|default( 'original' ) ) %}
                {% set src = imageAlias ? asset( imageAlias.uri ) : "//:0" %}
                {% set attrs = {
                    class: parameters.class|default(''),
                    height: parameters.height is defined ? parameters.height : (imageAlias ? imageAlias.height : ''),
                    width: parameters.width is defined ? parameters.width : (imageAlias ? imageAlias.width : ''),
                } %}

                <img src="{{ src }}" alt="{{ parameters.alternativeText|default(field.value.alternativeText) }}" {% for attrname, attrvalue in attrs if attrvalue %}{{ attrname }}="{{ attrvalue }} " {% endfor %}/>
            </figure>
        {% endif %}
    {% endspaceless %}
{% endblock %}
